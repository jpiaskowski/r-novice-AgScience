---
title: Saving Data & Plots
teaching: 10
exercises: 10
questions:
- "How can I save plots and data created in R?"
objectives:
- "To be able to write out plots and data from R."
keypoints:
- "Save plots from RStudio using the 'Export' button."
- "Use `write.table` to save tabular data."
source: Rmd
---

```{r eval=FALSE, include=FALSE}
# source("../bin/chunk-options.R")
# knitr_fig_path("11-")
```

## Writing tabular data to a file

At some point, you'll also want to write out data from R to a file. 

We can use the `write.csv()` function for this, which is very similar to `read.csv()` from before. This is a wrapper for  `read.table()` with specific default arguments. 

Let's create a data-cleaning script, for this analysis, we only want to focus on the NASS alfalfa data in 
```
hay <- read.csv("data/historical_hay_data.csv")
hay_ID <- hay[hay$state == "Idaho", ]

write.csv(hay_ID, file="hay_data_Idaho.csv", row.names = F)
```

```{r, echo=F}
hay <- read.csv("data/historical_hay_data.csv")
hay_ID <- hay[hay$state == "Idaho", ]
par(mar=c(1,1,1,1))
```

## Saving plots

You can save a plot from within RStudio using the 'Export' button in the 'Plot' window. This will give you the option of saving as a .pdf or as .png, .jpg or other image formats. 

Sometimes you will want to save plots without creating them in the 'Plot' window first. Perhaps you want to make a pdf document with multiple pages: each one a different plot, for example. Or perhaps you're looping through multiple subsets of a file, plotting data from each subset, and you want to save each plot, but obviously can't stop the loop to click 'Export' for each one.  

In this case you can use a more flexible approach. The function `png()` creates a new png device. You can control the size and resolution using the arguments of this function.

```{r}
hay_ID$total_yield <- hay_ID$acres*hay_ID$yield/1000000

png("total-yield-over-time.png", width=6, height=5, units = "in", res = 300)

plot(hay_ID$year, hay_ID$total_yield, type = "l", xlab = "Year", 
     ylab = "Yield (millions of tons)", lwd = 2, 
     main = "Idaho Alfalfa Production", col = "yellowgreen")

dev.off() # the graphics device must be turned off after generating the plot
```

The commands `jpeg()`, `png()` etc. are used similarly to output plots in different formats.

